{
   "type": "object",
   "$id": "Table.json",
   "$schema": "https://json-schema.org/draft/2020-12/schema",

   "description": "Table object that handles select, insert, update and delete",
   "additionalProperties": false,

   "properties":
   {
      "Table":
      {
         "type": "object",
         "description": "The source object (table,view or query)",
         "additionalProperties": false,
         "required": ["source","invoke"],

         "properties":
         {
            "source":
            {
               "type": "string",
               "description": "The source object (table,view or query)"
            }
            ,
            "session":
            {
               "type": "string",
               "description": "Valid session id"
            }
            ,
            "invoke":
            {
               "type": "string",
               "description": "Method to invoke",
               "enum": ["select()", "insert()", "update()", "delete()"]
            }
            ,
            "bindvalues":
            {
               "type": "array",
               "items": {"$ref": "#/types/BindValue"}
            }
            ,
            "update()":
            {
               "additionalProperties": false,
               "required": ["columns"],

               "properties":
               {
                  "columns":
                  {
                     "type": "array",
                     "items": {"$ref": "#/types/NameValuePair"}
                  }
                  ,
                  "assertions":
                  {
                     "type": "array",
                     "items": {"$ref": "#/types/NameValuePair"}
                  }
                  ,
                  "filter":
                  {
                     "type": "array",
                     "anyOf":
                     [
                        {"$ref": "#/types/Filter"},
                        {"$ref": "#/types/Constraint"}
                     ]
                  }
               }
            }
         }
      }
   }
   ,


   "types":
   {
      "BindValue":
      {
         "type": "object",
         "required": ["name","type"],
         "additionalProperties": false,

         "properties":
         {
            "name": {"type": "string"},
            "type": {"type": "string"},
            "value": {"type": ["string","number","integer","boolean"]}
         }
      }
      ,
      "NameValuePair":
      {
         "type": "object",
         "required": ["name","value"],
         "additionalProperties": false,

         "properties":
         {
            "name": {"type": "string"},
            "value": {"type": ["string","number","integer","boolean"]}
         }
      }
      ,
      "Clause":
      {
         "type": "string",
         "enum": ["where", "and", "or"]
      }
      ,
      "Filter":
      {
         "type": "array",
         "items":
         {
            "anyOf":
            [
               {"$ref": "#/types/Filter"},
               {"$ref": "#/types/Constraint"}
            ]
         }
      }
      ,
      "Constraint":
      {
         "type": "object",
         "required": ["column","filter","value"],
         "additionalProperties": false,

         "properties":
         {
            "or": {"type": "boolean"},
            "column": {"type": "string"},
            "filter": {"type": "string"},
            "value": {"type": ["string","number","integer","boolean"]}
         }

      }
   }
 }